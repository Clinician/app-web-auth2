<!DOCTYPE html>
<html>
<head>
  <base href="/access/SDK-VERSION-NUM/">
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">
  <title>Pryv</title>
  <link href='https://fonts.googleapis.com/css?family=Roboto:400,300,500,700,400italic|Roboto+Condensed:400,300,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="https://d3gblc8a9weyfb.cloudfront.net/browser/styles/vendor.min.css"/>
  <link rel="stylesheet" type="text/css" href="media/styles/access.css"/>
</head>
<body>

  <div id="simple-page-wrapper">
    <img class="logo" src="media/images/logo-minimal.png"/>

    <h1>Go to your Pryv</h1>

    <div class="alert alert-danger hidden" role="alert"><strong>Username unknown</strong></div>
    <!-- Registration Form Wrapper -->
    <div id="signinhub-content-wrapper" class="signinhubContainer">
      <form role="form" onsubmit="return false;">
        <div id="signinhub-content"  class="form-group">
          <div class="input-group">
            <input class="form-control" type="username" name="username" id="signinhub-input" placeholder="Enter your username" autocorrect="off" autocapitalize="off"/>
            <span class="input-group-btn">
              <button type="submit" id="signinhub-form-toggle" class="btn btn-primary form-toggle" data-mode="register">Go</button>
            </span>
          </div>
        </div>
      </form>
    </div>

    <p><strong>Not yet a user?</strong> <a href="/access/register.html">Register for a free beta account here</a>.</p>

    <p><strong>Why is this step necessary?</strong> Good question. It's only temporary; soon you'll be able to just sign in directly.</p>
  </div>

  <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="/access/SDK-VERSION-NUM/bootstrap.min.js"></script>
  <!-- <script type="text/javascript" src="/lib/jquery.js"></script> -->

  <script>
    $(document).ready(function(){
      var $toggle = $('#signinhub-form-toggle');
      var $alert = $('.alert');

      var domain = document.location.hostname.substr(document.location.hostname.indexOf('.') + 1);
      $toggle.click(function () {
        $toggle.prop('disabled', true);
        $alert.addClass('hidden');
        var username = $('#signinhub-input').val().trim();
        $.post('https://reg.' + domain + '/' + username + '/server').done( function () {
          window.location = 'https://' + username + '.' + domain + '/#/SignIn';
        }).fail(function () {
          $alert.removeClass('hidden');
        }).always(function () {
          $toggle.prop('disabled', false);
        });
        //
      });
    });
  </script>
</body>
</html>
